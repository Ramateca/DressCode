<div class="flex min-h-screen bg-dresscode-muted dark:bg-gray-900">
  <!-- Sidebar -->
  <aside
    class="w-64 bg-white dark:bg-gray-800 shadow-soft dark:shadow-none p-6 space-y-10 hidden md:block flex-shrink-0 font-sans border-r border-gray-200 dark:border-gray-700"
  >
    <div class="text-2xl font-display font-bold text-dresscode-main dark:text-dresscode-light">
      <span class="text-dresscode-main dark:text-red-500">Dress</span
      ><span class="text-dresscode-dark dark:text-red-700">Code</span>
    </div>
    <div ngbDropdown class="relative inline-block text-left" #mainDropdown="ngbDropdown">
      <button
        class="inline-flex justify-center w-full px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:text-gray-500 dark:hover:text-gray-300"
        id="dropdownMenu"
        ngbDropdownToggle
      >
        <span>{{ user()?.username }}</span>
        <svg class="w-5 h-5 ml-2 -mr-1 text-gray-400 dark:text-gray-500" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
        </svg>
      </button>

      <div
        ngbDropdownMenu
        aria-labelledby="dropdownMenu"
        [class.hidden]="!mainDropdown.isOpen()"
        class="absolute mt-2 origin-top-right bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 divide-y divide-gray-100 dark:divide-gray-700 rounded-md shadow-lg w-56 z-50"
      >
        <div class="px-4 py-3">
          <p class="text-sm leading-5 text-gray-500 dark:text-gray-400">Signed in as</p>
          <p class="text-sm font-medium leading-5 text-gray-900 dark:text-white truncate">{{ user()?.email }}</p>
        </div>

        <!-- THEME SUBMENU -->
        <div ngbDropdown class="relative group" #themeDropdown="ngbDropdown">
          <button
            class="w-full flex justify-between items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"
            ngbDropdownToggle
          >
            Theme
            <svg class="w-4 h-4 ml-2 transform transition-transform text-gray-400 dark:text-gray-500" [class.rotate-90]="themeDropdown.isOpen()" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
            </svg>
          </button>

          <!-- SUBMENU -->
          <div
            ngbDropdownMenu
            [class.hidden]="!themeDropdown.isOpen()"
            id="themeDropdownMenu"
            class="absolute left-full top-0 ml-1 mt-0 w-40 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg z-50"
          >
            <a href="javascript:void(0)" (click)="setTheme('light')" class="flex justify-between items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
              Light
              @if (themeService.theme === 'light') {
                <span class="ml-auto">
                  <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                </span>
              }
            </a>
            <a href="javascript:void(0)" (click)="setTheme('dark')" class="flex justify-between items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
              Dark
              @if (themeService.theme === 'dark') {
                <span class="ml-auto">
                  <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                </span>
              }
            </a>
            <a href="javascript:void(0)" (click)="setTheme('system')" class="flex justify-between items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
              System
              @if (themeService.theme === 'system') {
                <span class="ml-auto">
                  <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                </span>
              }
            </a>
          </div>
        </div>

        <!-- OTHER MENU ITEMS -->
        <div class="py-1">
          <a class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700" (click)="openUserSettings()">Account settings</a>
          <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700" (click)="logout()">Sign out</a>
        </div>
      </div>
    </div>


    <nav class="space-y-4">
      <a href="#" class="block text-dresscode-main dark:text-red-500 font-semibold">Recents</a>
      <a href="#" class="block text-gray-600 dark:text-gray-300 hover:text-dresscode-main dark:hover:text-red-500">Shared files</a>
      <a href="#" class="block text-gray-600 dark:text-gray-300 hover:text-dresscode-main dark:hover:text-red-500">Starred</a>
      <a href="#" class="block text-gray-600 dark:text-gray-300 hover:text-dresscode-main dark:hover:text-red-500">Trash</a>
    </nav>
    <button
      class="w-full bg-dresscode-main dark:bg-red-600 text-white dark:text-gray-100 py-2 px-4 rounded-lg hover:bg-dresscode-dark dark:hover:bg-red-700 transition"
      (click)="createVestito()"
    >
      + New {{ "Dress" | glossario }}
    </button>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-6 md:p-10">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      @for (vestito of vestiti.value(); track vestito.id) {
      <div
        (click)="openVestito(vestito.id)"
        class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-soft dark:shadow-none border border-gray-200 dark:border-gray-700 hover:shadow-lg dark:hover:border-gray-600 transition cursor-pointer"
      >
        <h3 class="text-lg font-bold mb-1 text-gray-900 dark:text-white">{{ vestito.title }}</h3>
        <p class="text-sm text-dresscode-text-muted dark:text-gray-400 mb-2">
          {{ vestito.submissionCount }} responses
        </p>
        <p class="text-sm text-dresscode-text-muted dark:text-gray-400">
          Updated {{ vestito.updatedAt | date : "short" }}
        </p>
      </div>
      }
    </div>
  </main>
</div>
